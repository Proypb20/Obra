SELECT ROW_NUMBER() OVER (ORDER BY "O"."NAME") AS "ID"
     , "O"."ID" AS "OBRA_ID"
     , "O"."NAME" AS "OBRA"
     , "DATE" AS "FECHA"
     , "S"."LAST_NAME" || ', ' || "S"."FIRST_NAME" AS "SUBCONTRATISTA"
     , "TC"."NAME" AS "TIPO_COMPROBANTE"
     , "T"."TRANSACTION_NUMBER"
     , "C"."NAME" AS "CONCEPTO"
     , NULL AS "DEBIT_AMOUNT"
     , "T"."AMOUNT" AS "CREDIT_AMOUNT"
  FROM "PUBLIC"."TRANSACCION" "T"
  INNER JOIN "PUBLIC"."OBRA" "O" ON "T"."OBRA_ID" = "O"."ID"
  INNER JOIN "PUBLIC"."SUBCONTRATISTA" "S" ON "T"."SUBCONTRATISTA_ID" = "S"."ID"
  INNER JOIN "PUBLIC"."TIPO_COMPROBANTE" "TC" ON "T"."TIPO_COMPROBANTE_ID" = "TC"."ID"
  INNER JOIN "PUBLIC"."CONCEPTO" "C" ON "T"."CONCEPTO_ID" = "C"."ID";
